<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title class="lead">Polygenic Risk Scores</title>
  <!-- Bootstrap -->
  <link href="css/bootstrap-4.2.1.css" rel="stylesheet">
  <link href="css/bootstrap-tour.min.css" rel="stylesheet">
  <link href="css/multiselect.css" rel="stylesheet"> <!-- TODO -->
</head>
<script src="js/multiselect.min.js"></script> 
<body onload="getTraits()">
  <div class='p-9 bg-primary text-center'>
    <a href="index.html#feedback" class="mb-4 text-center text-bold text-white old-bv">Welcome to the Beta version of
      our website! --Click here to leave us comments or questions</a>
  </div>
  <nav class="navbar navbar-expand-lg navbar-dark bg-dark sticky-top">
    <a class="navbar-brand" href="#">Calculate Risk Scores</a>

    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent"
      aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation"> <span
        class="navbar-toggler-icon"></span> </button>
    <!-- The justify-content-end command in the next line aligns the menu to the right.-->
    <div class="collapse navbar-collapse justify-content-end" id="navbarSupportedContent">
      <ul class="navbar-nav">

        <li class="nav-item active"> <a class="nav-link" href="index.html">Home </a> </li>

        <div class="active-page">
          <li class="nav-item"> <a class="nav-link" href="calculate_score.html">Calculate Score</a> </li>
        </div>
        <li class="nav-item"> <a class="nav-link" href="citations.html">Cite</a> </li>
        <li class="nav-item"> <a class="nav-link" href="api.html">API</a> </li>
        <li class="nav-item"> <a class="nav-link" href="learn_more.html">Learn More</a> </li>
      </ul>
    </div>
  </nav>
  <div class="jumbotron">
    <div class="container">
      <div class="row">
        <div class="col-12 col-md-8 mx-auto">

          <div class="row text-center">
            <div class="text-center col-12">
              <h2>How to Use the Calculator</h2>
              <h3 style="margin-bottom: 1rem;"> (in 7 easy steps) </h3>

              <script src="js/tour.js"></script>
              <button type="button" id="startTour" onclick="startTour();" class="btn btn-primary btn-lg">Start a
                Tour</button>
              <h3><br>1: Input RS IDs and Alleles</h3>


            </div>
            <div class="text-center col-12">
              <!-- CONTACT FORM https://github.com/jonmbake/bootstrap3-contact-form -->
              <form id="feedbackForm" class="text-center">

                <div class="form-text font-weight-bold">

                  <textarea rows="10" cols="100" class="form-control nowrap" id="input" name="input"
                    placeholder="rs3:AT,rs1:T rs4:G&#10;rs5:G&#10;rs6" aria-describedby="input rsID"></textarea>
                  <span id="messageHelp" class="form-text text-muted" style="display: none;">Please enter a
                    message.</span>
                </div>
              </form>

              <!--Code for this found at link: http://jsfiddle.net/jworboys/rUbr9/ -->
              <form>
                <div class="mx-button">
                  <input type="radio" name='mx' id="textInputButton" checked onclick="clickTextInput()">
                  <label for="textInputButton" unselectable>Text Input</label>
                </div>
                <div class="mx-button">
                  <input type="radio" name='mx' id="fileUploadButton" onclick="clickFileUpload()">
                  <label for="fileUploadButton" unselectable>File Upload</label>
                </div>
              </form>
              <!--End of code from above link-->

              <div class="text-black-50 float-right">
                <button class="btn1 example" id="exampleInput" onclick="exampleInput()">Example</button>
              </div>
              <br>
              <br>

              <form class="md-form" id="file-form" style="visibility: hidden;">
                <div class="file-field">
                  <div class="float-left">
                    <input type="file" id="files" name="file" />
                    <script src="js/handleFileSelect.js"></script>
                    <script>document.getElementById('files').addEventListener('change', handleFileSelect, false); </script>
                    <input type="hidden" id="uploadText" name="uploadTextValue" value="" />
                    <output id="list"></output>
                  </div>
                </div>
              </form>
              <p>&nbsp;</p>

              <div class='child'>
                <div class="col-lg-12 mb-0 mt-2 text-left">
                  <h5>2: Specify Ethnicity and Reference Genome&nbsp;</h5>
                    <select id='LD-ethnicitySelect'>
                      <option value="Admixed Ancestry" >Admixed Ancestry</option>
                      <option value="African American or Afro-Caribbean">African American or Afro-Caribbean</option>	
                      <option value="African unspecified">African unspecified</option>
                      <option value="Asian unspecified">Asian unspecified</option>
                      <option value="East Asian">East Asian</option>
                      <option value="European">European</option>
                      <option value="Greater Middle Eastern">Greater Middle Eastern</option>
                      <option value="Hispanic or Latin American">Hispanic or Latin American</option>
                      <option value="Native American">Native American</option>
                      <option value="Oceanian">Oceanian</option>
                      <option value="South Asian">South Asian</option>
                      <option value="South East Asian">South East Asian</option>
                      <option value="Sub-Saharan African">Sub-Saharan African</option>
                    </select>
                    <select id="refGenome">
                      <option selected="selected" value="default">--Reference Genome--</option>
                      <option value="hg38">GRCh38/hg38</option>
                      <option value="hg19">GRCh37/hg19</option>
                      <option value="hg18">NCBI36/hg18</option>
                      <option value="hg17">NCBI35/hg17</option>
                    </select>
                </div>
              </div>

              <div class='child'>
                <div class="col-lg-12 mb-0 mt-2 text-left">
                  <h5>3: Select Trait(s) of Interest&nbsp;</h5>
                    <select id='traitSelect' multiple></select>
                </div>
              </div>

              <div class='child'>
                <div class="col-lg-12 mb-0 mt-2 text-left">
                  <h5>4: Filter Studies by Type or Ethnicity&nbsp;</h5>
                    <select id='studyTypeSelect' multiple>
                      <option value="HI" selected="selected">High Impact Studies</option>
                      <option value="LC" >Large Cohort Studies</option>
                      <option value="O" >All Other Studies</option>    
                    </select>
                    <select id='ethnicitySelect' multiple>
                      <option value="Admixed Ancestry" selected='selected'>Admixed Ancestry</option>
                    </select>
                    <button class="btn btn-primary btn-sm" onClick="getStudies()">
                      Apply Filters
                    </button>
                </div>
              </div>
              
              <div class='child'>
                <div class="col-lg-12 mb-0 mt-2 text-left">
                  <h5>5: Select from Filtered Studies&nbsp;</h5>
                    <div id='studySelectContainer'>
                      <select id='studySelect' multiple>
                      </select>
                    </div>
                </div>
              </div>

              <div class='child'>
                <div class="col-lg-12 mb-.5 mt-2 text-left">
                  <h5>6: Enter P-Value Cutoff&nbsp;</h5>
                  <form action="#" method="POST" id="pvalInput" name="pvalOptions">
                    <div class="form-inline">
                      <div>
                        <input type="number" value="1.0" name = "pValScalarIn" id ="pValScalarIn" size = 5 min = 1.0 max = 10.0 onchange = "changePValScalar()">
                        x10^-
                        <input type="number" value="5" name="pValMagIn" id="pValMagIn" size = 5 min = 0.0 max = 100.0 onchange="changePValMagnitude()">
                      </div>
                      <label>
                        &nbsp;&nbsp;&nbsp;(
                        <output id="pvalScalar" name="pvalScalar" for="pValScalarIn">1.0</output>
                        x10
                        <sup>
                          <output id="pvalMagnigtude" name="pvalMagnigtude" for="pValMagIn">-5</output>
                        </sup>)
                      </label>
                    </div>
                  </form>
                </div>
              </div>

              <div class='child'>
                <div class="col-lg-12 mb-0 mt-2 text-left">
                  <h5>7: Select an Output File Format&nbsp;</h5>
                  <script src="js/calculate_score.js"></script>
                  <script src="js/vcf_parser.js"></script>
                  <div class="fileFormOptions">
                    <select id="fileType" , onchange="changeFormat();">
                      <option value="csv">CSV</option>
                      <option value="json">JSON</option>
                      <option value="text">Text</option>
                    </select>
                  </div>
                </div>
              </div>
              <!--
              <div class="container diseaseLists">
                <div class="row">
                  <div class='parent inline-flex-parent'>
                    <div class='child'>
                      <div class="col-lg-12 mb-0 mt-2 text-left">
                        <h5>Select Disease and Study&nbsp;</h5>
                        <script src="js/sharedCode.js"></script>
                        <script src="js/diseaseList.js"></script>
                        <h8>
                          <div class="diseaseLists">
                            <select id="disease" onchange="getStudies()">
                              <option value="">--Disease--</option>
                              <option value="all">All Diseases </option>
                            </select>
                          </div>
                          <div class="diseaseLists">
                            <select id="diseaseStudy" onchange="changeStudiesList()">
                              <option value="">--Study--</option>
                            </select>
                          </div>
                        </h8>
                      </div>
                    </div>
                    
                  </div>
                  <div class='parent inline-flex-parent'>
                    <div class='child'>
                      <div class="col-lg-12 mb-0 mt-2 text-left">
                        <h5>Select Trait<span data-toggle="tooltip" title="Blurb about choosing a disease"><sup>&#63;</sup></span> and Study<span data-toggle="tooltip" title="Blurb about choosing a study"><sup>&#63;</sup></span>&nbsp;</h5>
                        <script src="js/sharedCode.js"></script>
                        <script src="js/diseaseList.js"></script>
                          <div class="autocomplete" style="width:300px;">
                            <input id="diseaseInput" type="text" name="myDisease" placeholder="Search a disease or type All diseases">
                          </div>
                          <input type="submit" value="Select" onclick="ChangeDiseaseList()">
                          <div class="diseaseLists">
                            <select id="diseaseStudy" disabled onchange="changeStudiesList()">
                              <option value="">--Study--</option>
                            </select>
                          </div>

                          <script type="text/javascript" src="js/autocomplete.js"></script>

                          <div class="diseaseLists">
                            <select id="disease" onchange="ChangeDiseaseList()">
                              <option value="">--Disease--</option>
                              <option value="all">All Diseases </option>
                              <option value="adhd">ADHD</option>
                              <option value="ad">Alzheimer's Disease</option>
                              <option value="als">ALS</option>
                              <option value="coronary_heart_disease">Coronary Heart Disease</option>
                              <option value="dep">Depression</option>
                              <option value="hf">Heart Faliure</option>
                              <option value="t1d">Type 1 Diabetes Mellitus</option>
                              <option value="t2d">Type 2 Diabetes Mellitus</option>
                            </select>
                          </div>
                          <div class="diseaseLists">
                            <select id="diseaseStudy" onchange="changeStudiesList()">
                              <option value="">--Study--</option>
                            </select>
                          </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
              <p>&nbsp;</p>
              -->

              <!--uses "js/calculate_score.js"-->
              <button type="button" id="feedbackSubmit" onclick="calculatePolyScore();"
                class="btn btn-primary btn-lg">Calculate Risk Scores</button>
              <!--TODO
                <button type="button" id="testButton" onclick="TestFileSendWithoutForm();"
                class="btn btn-primary btn-lg">Test Button</button>-->
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="container">
      <div class="row">
        <div class="col-12 col-md-8 mx-auto">

          <div class="row text-center" style="display: none" id="resultsDisplay">
            <div class="text-center col-12">
              <h2><br>Results</h2>

            </div>
            <div class="text-center col-12">
              <!-- CONTACT FORM https://github.com/jonmbake/bootstrap3-contact-form -->
              <form id="responseBox" class="text-center">
                <div class="form-text font-weight-bold">
                  <textarea readonly rows="10" cols="100" class="form-control nowrap" id="response" name="response"
                    placeholder="Results" aria-describedby="response to query"></textarea>
                </div>
              </form>
              <p>&nbsp;</p>
              <script type="text/javascript" src="js/dist/jszip.min.js"></script>
              <script type="text/javascript" src="js/dist/FileSaver.min.js"></script>
              <div class="downloadResults">
                <button type="button" id="downloader" onclick="downloadResults();" class="btn btn-primary">Download
                  Results</button>
              </div>
              <form class="md-form" id="download-bar" style="visibility: hidden;">
                <p1>
                  Please wait while your results are downloading.
                </p1>
              </form>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  <footer class="text-center" style="background-color: #343a40;">
    <div class="container">
      <div class="row">
        <div class="col-12 text-white" style="margin-top: 1rem;">
          <p>Copyright Â© Miller et al. (2020) All rights reserved.</p>
        </div>
      </div>
    </div>
  </footer>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="js/jquery-3.3.1.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="js/popper.min.js"></script>
  <script src="js/bootstrap-4.2.1.js"></script>
  <script src="js/bootstrap-tour.min.js"></script>
  <script src="js/multiselect.min.js"></script> 
  <script>
    document.multiselect('#ethnicitySelect')
    //document.multiselect('#traitSelect')
    document.multiselect('#studyTypeSelect')
    //document.multiselect('#studySelect')
  </script>

</body>

</html>