<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title class="lead">Polygenic Risk Scores</title>
  <!-- Bootstrap -->
  <link href="css/topnav.css" rel="stylesheet">
  <link href="css/banner.css" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
  <link href="css/bootstrap-4.2.1.css" rel="stylesheet">
  <link href="css/bootstrap-tour.min.css" rel="stylesheet">
  <link href="css/multiselect.css" rel="stylesheet"> <!-- TODO -->
</head>
<script src="js/multiselect.min.js"></script>

<body onload="getTraits(); getEthnicities();">

  <div id="topnav" class='topnav'>
    <a href="index.html">HOME</a>
    <a href="calculate_score.html">CALCULATE</a>
    <a href="cite.html">CITE</a>
    <a href="cli_download.html">DOWNLOAD</a>
    <a href="about.html">ABOUT</a>
    <a href="https://biology.byu.edu/kauwe-lab">THE LAB</a>
    <a href="javascript:void(0);" class="icon" onclick="sidemenuFunction()">
      <i class="fa fa-bars"></i>
    </a>
  </div>

  <script>
    function sidemenuFunction() {
      var topnav = document.getElementById("topnav");
      if (topnav.className.includes("responsive")) {
        topnav.classList.remove("responsive");
      } 
      else {
        topnav.classList.add("responsive");
      }
    }
  </script>

  <header>
    <div class="banner">
      <img src="/images/dnaCalcBanner.jpg" width="100%" style="overflow: hidden;">
      <div class="centered-title-button">How to Use the Calculator</div>
      <div class="centered-subtitle-button"> (in 7 easy steps) </div>
      <script src="js/tour.js"></script>
      <div class="centered-button">
        <button type="button" id="startTour" onclick="startTour();" class="btn btn-primary btn-bnnr">Start a Tour</button> 
      </div>
    </div>
    
  </header>

  <div class="jumbotron">
    <div class="container">
      <div class="row">
        <div class="col-12 col-md-8 mx-auto">
          <div class="row text-center">
            <div class="text-center col-12">
              <h3>1: Input RS IDs and Alleles</h3>
            </div>
            <div class="text-center col-12">
              <!-- CONTACT FORM https://github.com/jonmbake/bootstrap3-contact-form -->
              <form id="feedbackForm" class="text-center">

                <div class="form-text font-weight-bold">

                  <textarea rows="10" cols="100" class="form-control nowrap" id="input" name="input"
                    placeholder="rs3:A,T&#10;rs1:T,C&#10;rs4:G,C&#10;rs5:G,A&#10;" aria-describedby="input rsID"></textarea>
                  <span id="messageHelp" class="form-text text-muted" style="display: none;">Please enter a
                    message.</span>
                </div>
              </form>

              <!--Code for this found at link: http://jsfiddle.net/jworboys/rUbr9/ -->
              <form>
                <div class="mx-button">
                  <input type="radio" name='mx' id="textInputButton" checked onclick="clickTextInput()">
                  <label for="textInputButton" unselectable>Text Input</label>
                </div>
                <div class="mx-button">
                  <input type="radio" name='mx' id="fileUploadButton" onclick="clickFileUpload()">
                  <label for="fileUploadButton" unselectable>File Upload</label>
                </div>
              </form>
              <!--End of code from above link-->

              <div class="text-black-50 float-right">
                <button class="btn1 example" id="exampleInput" onclick="exampleInput()">Example</button>
              </div>
              <br>
              <br>

              <form class="md-form" id="file-form" style="visibility: hidden;">
                <div class="file-field">
                  <div class="float-left">
                    <input type="file" id="files" name="file" />
                    <script src="js/handleFileSelect.js"></script>
                    <script>document.getElementById('files').addEventListener('change', handleFileSelect, false); </script>
                    <input type="hidden" id="savedVCFInput" value="" />
                    <input type="hidden" id="savedTextInput" value="" />
                    <output id="list"></output>
                  </div>
                </div>
              </form>
              <p>&nbsp;</p>

              <div class='child'>
                <div class="col-lg-12 mb-0 mt-2 text-left" style="background-color: whitesmoke; padding: .5em;">
                  <h5>2: Specify Sample Information &nbsp;</h5>
                  <select id="refGenome" onchange="moveToNextTourIndex('refGen')">
                    <option selected="selected" value="default">--Reference Genome--</option>
                    <option value="hg38">GRCh38/hg38</option>
                    <option value="hg19">GRCh37/hg19</option>
                    <option value="hg18">NCBI36/hg18</option>
                    <option value="hg17">NCBI35/hg17</option>
                  </select>
                  <select id='LD-ethnicitySelect' onchange="moveToNextTourIndex('superPop')">
                    <option selected="selected" value="default">--LD Ethnicity--</option>
                    <option>African</option>
                    <option>American</option>
                    <option>East Asian</option>
                    <option>European</option>
                    <option>South Asian</option>
                  </select>
                  <select id="sex">
                    <option selected="selected" value="default">--Sex--</option>
                    <option value="f">Female</option>
                    <option value="m">Male</option>
                  </select>
                </div>
              </div>

              <!--This div id is used for the bootstrap tour-->
              <div id='traitSelectContainer' class='child'>
                <div class="col-lg-12 mb-0 mt-2 text-left" style="padding: .5em;">
                  <h5>3: Select Trait(s) of Interest&nbsp;</h5>
                  <select id='traitSelect' multiple></select>
                </div>
              </div>

              <div class='child'>
                <div class="col-lg-12 mb-0 mt-2 text-left" style="background-color: whitesmoke; padding: .5em;">
                  <h5>4: Filter Studies by Type or Ethnicity&nbsp;</h5>
                  <select id='studyTypeSelect' multiple>
                    <option value="HI" selected="selected">High Impact Studies</option>
                    <option value="LC" selected="selected">Large Cohort Studies</option>
                    <option value="O" selected="selected">All Other Studies</option>
                  </select>
                  <select id='ethnicitySelect' multiple></select> 
                  <button id='applyFilters' class="btn btn-primary btn-sm" style="margin-left: 1rem;" onClick="getStudies()">
                    Apply Filters
                  </button>
                </div>
              </div>

              <div class='child'>
                <div class="col-lg-12 mb-0 mt-2 text-left" style="padding: .5em;">
                  <h5>5: Select from Filtered Studies&nbsp;</h5>
                  <div id='studySelectContainer'>
                    <select id='studySelect' multiple>
                    </select>
                  </div>
                </div>
              </div>

              <div class='child'>
                <div class="col-lg-12 mb-.5 mt-2 text-left" style="background-color: whitesmoke; padding: .5em;">
                  <h5>6: Enter P-Value Cutoff&nbsp;</h5>
                  <form action="#" method="POST" id="pvalInput" name="pvalOptions">
                    <div class="form-inline">
                      <div>
                        <input type="number" value="1.0" name="pValScalarIn" id="pValScalarIn" size=5 min=1.0 max=10.0
                          onchange="changePValScalar()">
                        x10^-
                        <input type="number" value="5" name="pValMagIn" id="pValMagIn" size=5 min=0.0 max=100.0
                          onchange="changePValMagnitude()">
                      </div>
                      <label>
                        &nbsp;&nbsp;&nbsp;(
                        <output id="pvalScalar" name="pvalScalar" for="pValScalarIn">1.0</output>
                        x10
                        <sup>
                          <output id="pvalMagnigtude" name="pvalMagnigtude" for="pValMagIn">-5</output>
                        </sup>)
                      </label>
                    </div>
                  </form>
                </div>
              </div>

              <div class='child'>
                <div class="col-lg-12 mb-0 mt-2 text-left" style="padding: .5em;">
                  <h5>7: Select an Output File Format&nbsp;</h5>
                  <script src="js/calculate_score.js"></script>
                  <script src="js/formatHelper.js"></script>
                  <script src="js/vcf_parser.js"></script>
                  <div class="fileFormOptions">
                    <select id="fileType" , onchange="changeFormat();">
                      <option value="csv">CSV</option>
                      <option value="json">JSON</option>
                      <option value="text">Text</option>
                    </select>
                    <select id="fileFormat", onchange="changeFormat();">
                      <option selected="selected" value="condensed">Condensed</option>
                      <option value="full">Full</option>
                    </select>
                  </div>
                </div>
              </div>
              <!--uses "js/calculate_score.js"-->
              <button type="button" id="feedbackSubmit" onclick="calculatePolyScore();"
                class="btn btn-primary btn-lg" style="margin-top: .5em; padding: .5em;">Calculate Risk Scores</button>
              <!--TODO
                <button type="button" id="testButton" onclick="TestFileSendWithoutForm();"
                class="btn btn-primary btn-lg">Test Button</button>-->
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="container">
      <div class="row">
        <div class="col-12 col-md-8 mx-auto">

          <div class="row text-center" style="display: none" id="resultsDisplay">
            <div class="text-center col-12">
              <h2><br>Results</h2>

            </div>
            <div class="text-center col-12">
              <!-- CONTACT FORM https://github.com/jonmbake/bootstrap3-contact-form -->
              <form id="responseBox" class="text-center">
                <div class="form-text font-weight-bold">
                  <textarea readonly rows="10" cols="100" class="form-control nowrap" id="response" name="response"
                    placeholder="Results" aria-describedby="response to query"></textarea>
                </div>
              </form>
              <p>&nbsp;</p>
              <script type="text/javascript" src="js/dist/jszip.min.js"></script>
              <script type="text/javascript" src="js/dist/FileSaver.min.js"></script>
              <div class="downloadResults">
                <button type="button" id="downloader" onclick="downloadResults();" class="btn btn-primary">Download
                  Results</button>
              </div>
              <form class="md-form" id="download-bar" style="visibility: hidden;">
                <p1>
                  Please wait while your results are downloading.
                </p1>
              </form>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  <footer class="text-center" style="background-color: #343a40;">
    <div class="container">
      <div class="row">
        <div class="col-12 text-white" style="margin-top: 1rem;">
          <p>Copyright © Miller et al. (2020) All rights reserved.</p>
        </div>
      </div>
    </div>
  </footer>
  <!-- Making the top menu sticky -->
  <script>
    window.onscroll = function() {myFunction()};
    
    var topnav = document.getElementById("topnav");
    var sticky = topnav.offsetTop;
    
    function myFunction() {
      if (window.pageYOffset >= sticky) {
        topnav.classList.add("sticky")
      } else {
        topnav.classList.remove("sticky");
      }
    }
  </script>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script src="js/jquery-3.3.1.min.js"></script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="js/popper.min.js"></script>
  <script src="js/bootstrap-4.2.1.js"></script>
  <script src="js/bootstrap-tour.min.js"></script>
  <script src="js/multiselect.min.js"></script>
  <script src="js/sharedCode.js"></script>
  <script>
    //document.multiselect('#ethnicitySelect')
    //document.multiselect('#traitSelect')
    document.multiselect('#studyTypeSelect')
    //document.multiselect('#studySelect')
  </script>

</body>

</html>